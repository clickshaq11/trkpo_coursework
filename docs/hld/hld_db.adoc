== Схемы бд

[plantuml,"hld_db","png"]
----------
include::hld_db.puml[]
----------

=== User

Таблица профилей пользователей. Содержит логин, хешированный пароль и краткую информацию пользователя

|===
|Название поля|Тип|Ограничения

|id
|serial
|PK - unique, not null

|login
|varchar
|unique, not null, длина не меньше 8 и не больше 50 символов

|hashedPassword
|varchar
|not null

|shortInfo
|varchar
|not null, длина не меньше 1 символа и не больше 250 символов
|===

=== Post

Таблица постов. Содержит ссылку на автора поста, название, тело поста и таймстемп создания поста в utc миллисекундах

|===
|Название поля|Тип|Ограничения|Комментарий

|id
|serial
|PK - unique, not null
|-

|authorId
|int
|FK, not null
|-

|title
|varchar
|not null, длина не меньше 1 символа и не больше 120 символов
|-

|body
|varchar
|not null, длина не меньше 1 символа и не больше 600 символов
|-

|createdAt
|bigint
|not null
|таймстемп utc в миллисекундах
|===

=== Comment

Таблица комментариев - содержит текст комментария, ссылку на пост, под которым оставлен комментарий, и ссылку на автора, который оставил комментарий

|===
|Название поля|Тип|Ограничения

|id
|serial
|PK - unique, not null

|userId
|int
|FK, not null

|postId
|int
|FK, not null

|body
|varchar
|not null, длина не меньше 1 символа и не больше 600 символов
|===

=== Notification

Таблица уведомлений. Содержит ссылку на пользователя, которому предназначается уведомление, ссылку на пост, который вызвал создание уведомления, и таймстемп создания уведомления в utc миллисекундах. Уведомления, для которых `createdAt + 30 дней < = текущий utc таймстемп`, удаляются.

|===
|Название поля|Тип|Ограничения|Комментарий

|id
|serial
|PK - unique, not null
|-

|userId
|int
|FK, not null
|-

|postId
|int
|FK, not null
|-

|createdAt
|bigint
|not null
|таймстемп utc в миллисекундах
|===

=== PostToUserLike

Таблица отметок "нравится". Содержит ссылку на пост, на который поставлена отметка, и ссылку на пользователя, поставившего отметку. Содержит уникальный индекс на {userId, postId}

|===
|Название поля|Тип|Ограничения

|id
|serial
|PK - unique, not null

|userId
|int
|FK, not null

|postId
|int
|FK, not null
|===

=== UserToSubscribedUser

Таблица подписок. Содержит ссылку на пользователя, на которого подписались, и ссылку на пользователя, который подписался. Содержит уникальный индекс {creatorId, subscriberId}

|===
|Название поля|Тип|Ограничения|Комментарий

|id
|serial
|PK - unique, not null
|-

|creatorId
|int
|FK, not null
|идентификатор пользователя, на которого подписаны

|subscriberId
|int
|FK, not null
|идентификатор пользователя, который подписан
|===
