== API

=== Security

==== Авторизация

`POST /api/v1/security/auth`

===== Входные данные

[source,json]
{
    "login": "string",
    "password": "string"
}

===== Выходные данные

====== Тело

[source,json]
{
    "token": "string"
}

====== Коды ошибок

|===
|Код |Причины
|422
|ошибка валидации

|400
|логин не найден, пароль не совпал
|===

==== Регистрация

`POST /api/v1/security/register`

===== Входные данные

[source,json]
{
    "login": "string",
    "password": "string",
    "shortInfo": "string"
}

===== Выходные данные

====== Тело

[source,json]
{
    "token": "string"
}

====== Коды ошибок

|===
|Код |Причины
|422
|ошибка валидации

|400
|логин не уникален
|===

=== Профиль пользователя

==== Получение своего профиля

`GET /api/v1/user/me`

===== Входные данные

-

===== Выходные данные

====== Тело

[source,json]
{
    "login": "string",
    "shortInfo": "string",
    "subcriptions": [
        {
            "id": 1,
            "login": "string"
        }
    ]
}

====== Коды ошибок

|===
|Код |Причины

|401
|запрашивающий пользователь неавторизован
|===

==== Получение чужого профиля

`GET /api/v1/user/id/{id}`

где {id} - идентификатор пользователя

===== Входные данные

-

===== Выходные данные

====== Тело

[source,json]
{
    "id": 1,
    "login": "string",
    "shortInfo": "string",
    "subscribed": true
}

====== Коды ошибок

|===
|Код |Причины

|400
|идентификатор запрашиваемого пользователя совпадает с идентификатором запрашивающего

|401
|запрашивающий пользователь неавторизован

|404
|пользователь не найден
|===

==== Получение профилей по логину

`GET /api/v1/user/login/{login}`

где {login} - логин или часть логина пользователя. В ответ не включается профиль запрашивающего пользователя

===== Входные данные

-

===== Выходные данные

====== Тело

[source,json]
[
    {
        "id": 1,
        "login": "string",
        "shortInfo": "string",
        "subscribed": true
    }
]

====== Коды ошибок

|===
|Код |Причины

|401
|запрашивающий пользователь неавторизован
|===

==== Изменение своего профиля

`PUT /api/v1/user`

===== Входные данные

[source,json]
{
    "shortInfo": "string",
    "password": "string"
}

===== Выходные данные

====== Тело

-

====== Коды ошибок

|===
|Код |Причины
|422
|ошибка валидации

|401
|запрашивающий пользователь неавторизован
|===

=== Пост

==== Создание поста

`POST /api/v1/post`

===== Входные данные

[source,json]
{
    "title": "string",
    "body": "string"
}

===== Выходные данные

====== Тело

-

====== Коды ошибок

|===
|Код |Причины
|422
|ошибка валидации

|401
|запрашивающий пользователь неавторизован
|===

==== Получение всех своих постов

`GET /api/v1/post/filter/mine?page={page}&size={size}&sort={sort}`

где {page}, {size}, {sort} - параметры пагинации

===== Входные данные

-

===== Выходные данные

====== Тело

[source,json]
[
    {
        "id": 1,
        "title": "string",
        "body": "string",
        "authorId": 1,
        "authorLogin": "string",
        "createdAt": 1111111111,
        "likeCounter": 1,
        "hitLike": true
        "firstComments": [
            {
                "id": 1,
                "authorLogin": "string",
                "body": "string"
            }
        ]
    }
]

====== Коды ошибок

|===
|Код |Причины

|401
|запрашивающий пользователь неавторизован
|===

==== Получение всех постов пользователя

`GET /api/v1/post/user/{id}?page={page}&size={size}&sort={sort}`

где {page}, {size}, {sort} - параметры пагинации, {id} - идентификатор пользователя

===== Входные данные

-

===== Выходные данные

====== Тело

[source,json]
[
    {
        "id": 1,
        "title": "string",
        "body": "string",
        "authorId": 1,
        "authorLogin": "string",
        "createdAt": 111111111,
        "likeCounter": 1,
        "hitLike": true
        "firstComments": [
            {
                "id": 1,
                "authorLogin": "string",
                "body": "string"
            }
        ]
    }
]

====== Коды ошибок

|===
|Код |Причины

|401
|запрашивающий пользователь неавторизован

|404
|пользователь не найден
|===

==== Получение постов фида новостей

`GET /api/v1/post/filter/feed`

===== Входные данные

-

===== Выходные данные

====== Тело

[source,json]
[
    {
        "id": 1,
        "title": "string",
        "body": "string",
        "authorId": 1,
        "authorLogin": "string",
        "createdAt": 11111111111,
        "likeCounter": 1,
        "hitLike": true
        "firstComments": [
            {
                "id": 1,
                "authorLogin": "string",
                "body": "string"
            }
        ]
    }
]

====== Коды ошибок

|===
|Код |Причины

|401
|запрашивающий пользователь неавторизован
|===

==== Получение поста

`GET /api/v1/post/{id}`

где {id} - идентификатор поста

===== Входные данные

-

===== Выходные данные

====== Тело

[source,json]
{
    "title": "string",
    "body": "string",
    "createdAt": 11111111111,
    "authorId": 1,
    "authorLogin": "string",
    "likeCounter": 1,
    "hitLike": true,
    "isAuthor": true
}

====== Коды ошибок

|===
|Код |Причины

|401
|запрашивающий пользователь неавторизован

|404
|пост не найден
|===

==== Изменение поста

`PUT /api/v1/post/{id}`

где {id} - идентификатор поста

===== Входные данные

[source,json]
{
    "title": "string",
    "body": "string"
}

===== Выходные данные

====== Тело

-

====== Коды ошибок

|===
|Код |Причины

|422
|ошибка валидации

|401
|запрашивающий пользователь неавторизован

|403
|попытка изменить пост от пользователя, не являющегося автором поста

|404
|пост не найден
|===

==== Удаление поста

`DELETE /api/v1/post/{id}`

где {id} - идентификатор поста

===== Входные данные

-

===== Выходные данные

====== Тело

-

====== Коды ошибок

|===
|Код |Причины

|401
|запрашивающий пользователь неавторизован

|403
|попытка удалить пост от пользователя, не являющегося автором поста

|404
|пост не найден
|===

=== Комментарий

==== Получение комментариев для поста

`GET /api/v1/post/{id}/comment?page={page}&size={size}&sort={sort}`

где {page}, {size}, {sort} - параметры пагинации, {id} - идентификатор поста

===== Входные данные

-

===== Выходные данные

====== Тело

[source,json]
[
    {
        "id": 1,
        "authorLogin": "string",
        "body": "string"
    }
]

====== Коды ошибок

|===
|Код |Причины

|401
|запрашивающий пользователь неавторизован

|404
|пост не найден
|===

==== Создание комментария

`POST /api/v1/post/{id}/comment`

где {id} - идентификатор поста

===== Входные данные

[source,json]
{
    "body": "string"
}

===== Выходные данные

====== Тело

-

====== Коды ошибок

|===
|Код |Причины

|401
|запрашивающий пользователь неавторизован

|404
|пост не найден
|===

=== Подписка

==== Подписка/отписка на/от пользователя

`POST /api/v1/subscription/{userId}`

где userId - идентификатор пользователя, на которого нужно подписаться/от которого нужно отписаться

===== Входные данные

-

===== Выходные данные

====== Тело

[source,json]
{
    "subscribed": true
}

====== Коды ошибок

|===
|Код |Причины

|400
|попытка подписи на самого себя

|401
|запрашивающий пользователь неавторизован

|404
|пользователь не найден
|===

=== Отметка "Нравится"

==== Добавление/удаление отметки "Нравится"

`POST /api/v1/post/{id}`

где {id} - идентификатор поста

===== Входные данные

-

===== Выходные данные

====== Тело

[source,json]
{
    "hitLike": true
}

====== Коды ошибок

|===
|Код |Причины

|401
|запрашивающий пользователь неавторизован

|404
|пост не найден
|===

=== Уведомление

==== Получение своих уведомлений

`GET /api/v1/notification`

===== Входные данные

-

===== Выходные данные

====== Тело

[source,json]
[
    {
        "id": 1,
        "postId": 1
    }
]

====== Коды ошибок

|===
|Код |Причины

|401
|запрашивающий пользователь неавторизован
|===
